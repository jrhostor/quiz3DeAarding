<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />
    <title>Quiz</title>
  </head>
  <body>
    <div id="root"></div>

    <!-- Your app entry (Vite/React dev). In production this will point to the built JS file. -->
    <script type="module" src="/src/main.tsx"></script>

    <!-- Replit dev banner (OK to keep) -->
    <script src="https://replit.com/public/js/replit-dev-banner.js"></script>

    <!-- âœ… Post the height to the parent (Funnelish) so the iframe can auto-resize -->
<script>
  (function () {
    var last = 0, rafId = null, intervalId = null;

    function measure() {
      var h = Math.max(
        document.documentElement.scrollHeight,
        document.body.scrollHeight,
        document.documentElement.offsetHeight,
        document.body.offsetHeight,
        document.documentElement.clientHeight
      );
      if (Math.abs(h - last) > 1) {
        last = h;
        window.parent.postMessage({ type: "quiz:height", value: h }, "*");
      }
    }

    // Respond to parent nudges
    window.addEventListener("message", function (e) {
      if (e.data && e.data.type === "quiz:pleaseMeasure") measure();
    });

    // Initial + staged checks (hydration, fonts, images)
    window.addEventListener("load", function () {
      measure();
      setTimeout(measure, 80);
      setTimeout(measure, 200);
      setTimeout(measure, 500);
      setTimeout(measure, 1000);
    });

    // Re-measure on resize
    window.addEventListener("resize", function () {
      if (rafId) cancelAnimationFrame(rafId);
      rafId = requestAnimationFrame(measure);
    });

    // Re-measure on DOM changes
    new MutationObserver(measure).observe(document.body, {
      childList: true, subtree: true, attributes: true, characterData: true
    });

    // Short heartbeat for mobile viewport quirks
    intervalId = setInterval(measure, 800);
    document.addEventListener("visibilitychange", function () {
      if (document.hidden) { clearInterval(intervalId); intervalId = null; }
      else if (!intervalId) { intervalId = setInterval(measure, 800); measure(); }
    });
  })();
</script>
  </body>
</html>
